<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini GTA 5</title>
<style>
  body { margin: 0; background: #111; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; font-family: sans-serif;}
  canvas { border: 2px solid #fff; background: #2c3e50; }
  #score { position: absolute; top: 10px; left: 50%; transform: translateX(-50%); color: #fff; font-size: 24px; text-shadow: 2px 2px 5px black;}
</style>
</head>
<body>
<div id="score">Score: 0</div>
<canvas id="gameCanvas" width="800" height="600"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let score = 0;
let keys = {};
let bullets = [];
let enemies = [];

// Map / buildings
const buildings = [
  {x: 100, y: 100, width: 200, height: 50},
  {x: 400, y: 50, width: 50, height: 200},
  {x: 200, y: 400, width: 300, height: 50},
  {x: 600, y: 300, width: 50, height: 200}
];

// Player car
let player = {x: 50, y: 50, width: 40, height: 60, speed: 4};

// Controls
document.addEventListener('keydown', e => keys[e.key] = true);
document.addEventListener('keyup', e => keys[e.key] = false);

// Shoot bullets
document.addEventListener('keydown', e => {
  if(e.key === ' ') {
    bullets.push({x: player.x + player.width/2 - 5, y: player.y, width: 10, height: 20, speed: 8});
  }
});

// Spawn enemies
function spawnEnemy() {
  let x = Math.random() * (canvas.width - 40);
  let y = -40;
  enemies.push({x: x, y: y, width: 40, height: 60, speed: Math.random()*2 + 1});
}

// Collision check
function checkCollision(a, b) {
  return a.x < b.x + b.width && a.x + a.width > b.x &&
         a.y < b.y + b.height && a.y + a.height > b.y;
}

// Game loop
function update() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Move player
  if(keys['ArrowLeft'] && player.x > 0) player.x -= player.speed;
  if(keys['ArrowRight'] && player.x + player.width < canvas.width) player.x += player.speed;
  if(keys['ArrowUp'] && player.y > 0) player.y -= player.speed;
  if(keys['ArrowDown'] && player.y + player.height < canvas.height) player.y += player.speed;

  // Draw buildings
  ctx.fillStyle = '#7f8c8d';
  buildings.forEach(b => ctx.fillRect(b.x, b.y, b.width, b.height));

  // Draw player
  ctx.fillStyle = '#e74c3c';
  ctx.fillRect(player.x, player.y, player.width, player.height);

  // Move bullets
  bullets.forEach((b, i) => {
    b.y -= b.speed;
    ctx.fillStyle = '#f1c40f';
    ctx.fillRect(b.x, b.y, b.width, b.height);
    if(b.y + b.height < 0) bullets.splice(i,1);
  });

  // Spawn enemies randomly
  if(Math.random() < 0.02) spawnEnemy();

  // Move enemies
  enemies.forEach((e, i) => {
    e.y += e.speed;
    ctx.fillStyle = '#3498db';
    ctx.fillRect(e.x, e.y, e.width, e.height);

    // Collision with player
    if(checkCollision(player, e)) {
      alert('Game Over! Final Score: ' + score);
      location.reload();
    }

    // Collision with bullets
    bullets.forEach((b,j) => {
      if(checkCollision(b, e)) {
        bullets.splice(j,1);
        enemies.splice(i,1);
        score += 10;
        document.getElementById('score').innerText = `Score: ${score}`;
      }
    });

    // Remove enemy if off-screen
    if(e.y > canvas.height) enemies.splice(i,1);
  });

  requestAnimationFrame(update);
}

update();
</script>
</body>
</html>

